<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />
	<title>使用uploadify 上传插件demo</title>
	<link rel="stylesheet" href="../lib/css/base_style.css"/>
	<link rel="stylesheet" href="../lib/css/bootstrap.min.css"/>
	<link rel="stylesheet" href="css/uploadify.css">
	<!-- 结合selectivizr.js使IE8兼容css3选择器 注意它只对在单独的样式文件中有效 -->
	<!--[if lt IE 9]>
		<script src='../lib/css/html5Shiv.js'></script>
		<script src='../lib/css/respond.js'></script>
		<script src='../lib/css/nwmatcher.js'></script>
		<script src='../lib/css/selectivizr.js'></script>
	<![endif]-->

	<style>
		.mybutton{
			background-color: transparent;
			-webkit-border-radius: 0px;
			-moz-border-radius: 0px;
			border-radius: 0px;
			border: 0px solid transparent;
		}
		.upload-img-list{
			width: 340px;
		}
		.upload-img-list li{
			float:left;
			margin: 10px 5px 0 0;
			width: 80px;
			height: 80px;
			cursor: pointer;
			position: relative;
		}
		.upload-img-list li.loading{
			background: url('images/loading.gif') no-repeat center;
			border: 1px solid #ccc;
		}
		.upload-img-list li img{
			width: 100%;
			height:100%;
		}
	</style>
</head>
<body>
	<!--[if lte IE 8]>
	    <div class="error chromeframe">您的浏览器版本<strong>很旧很旧</strong>，为了正常地访问网站，请升级您的浏览器 <a target="_blank" href="http://browsehappy.com">立即升级</a></div>
	<![endif]-->
	
	<xmp theme="united">
		### test
	</xmp>
	
	<div class="container">
		<h1>已上传 0 张,还可以上传7张</h1>
		<ul class="upload-img-list clearfix">
			<li class="upload-btn">
				<input type="file" name="file_upload" id="filebtn">
			</li>
		</ul>
	</div>
	




	<!-- javascript 文件  -->
	<script src='../lib/js/jquery-1.10.2.min.js' ></script>
	<script src='../lib/js/bootstrap.min.js' ></script>
	<script src='../lib/js/jquery.easing.1.3.js'></script>
	<script src='../lib/js/jquery.mousewheel.js'></script>
	<script src='js/jquery.uploadify.min.js'></script>

	<!-- Markdown 渲染器 -->
	<script src='../vender/strapdown.js'></script>
	

	<script>
		$(document).ready(function(){
			$('#filebtn').uploadify({
				'swf'          	: "uploadify.swf",
				'uploader'     	: 'upload.php',
				'auto'				:  false,
				'button'       	: "选择照片",
				'height'       	: "80",
				'width'        	: '80',
				'buttonClass'  	: 'mybutton',
				'buttonImage'		: 'images/add-photo-multi.png',
				'queueID'      	: 'queue',
				'uploadLimit'  	: 7,
				'fileSizeLimit'   : '500kb',
				'itemTemplate' 	: '\
								        <div id="${fileID}" class="uploadify-queue-item">\
									        	<div class="cancel">\
									     			 <a href="javascript:$(\'#${instanceID}\').\
													 uploadify(\'cancel\', \'${fileID}\')">X</a>\
									        	</div>\
									        <span class="fileName">${fileName} (${fileSize})</span>\
									        <span class="data"></span>\
								        </div>' ,
				'onDialogClose'   :function(queueData){
					 console.log('加入了:'   +queueData.filesQueued + 
					 				 '选择了:'   +queueData.filesSelected　+ 
					 				 '队列长度:' +queueData.queueLength　+
			    					 "出错数:"   +queueData.filesErrored);
				},			
				'onUploadStart'	:function(file){
					console.log("开始上传..." + file.name);    //这里注意对比和服务器端返回的文件名
					var loadingButton = $('<li class="loading" />');
					var insertTag = $('.upload-img-list li:last-child'); 
					loadingButton.insertBefore(insertTag);
				},
				'onUploadSuccess' :function(file, data, response){
					console.log(file.name + "-->" + data);
					var tmp = $('.loading');
					tmp.append("<img src='uploads/"+data+"'/>");
					tmp.removeClass('loading');
				}
			});
		});
	</script>
</body>
</html>